# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Описание данных

### Интерфейсы и типы

#### IProduct
Описывает следующие типы данных для полей элемента продукта:
- id
- название
- изображение
- стоимость
- категория
- описание

#### IBasket
Описывает следующие типы данных для полей элемента корзины: 
- список покупок
- итоговая стоимость заказа

#### Тип PaymentMethod
Описывает тип метода оплаты товара, может принимать одно из двух значений: 
- `card` - выбран способ оплаты картой
- `cash` - выбран способ наличными средствами

#### IOrder
Описывает следующие типы данных, отправляемых на сервер при выполнении заказа: 
- тип оплаты
- адрес электронной почты
- номер телефона
- итоговая стоимость заказа
- список покупок

#### Тип OrderForm
Описывает типы данных для полей формы оформления заказа. Содержит те же поля и типы данных, что и `IOrder` за исключением `total` и `items`.

#### IOrderResult
Описывает следующие типы данных, получаемых с сервера после оформления заказа: 
- id продукта
- итоговая стоимость заказа

#### ISuccess
Описывает тип поля итоговой стоимости заказа для модального окна, уведомляющего о том, что заказ был выполнен успешно.

#### ISuccessActions
Описывает тип возвращаемого значения для функции `onClick` окна, уведомляющего о том, что заказ был выполнен успешно.

#### ICardActions
Описывает тип возвращаемого значения для функции `onClick` карточки.

#### IModalData
Описывает тип данных для содержимого модального окна.

#### IPage
Описывает типы данных для следующих компонентов главной страницы магазина:
- счётчик количества товаров в корзине
- список продуктов
- логическое значение, показывающее заблокирована прокрутка страницы или нет

#### IWebLarekAPI
Описывает типы принимаемых и возвращаемых данных для следующих методов: 
- `getProductsList` - получение списка продуктов
- `getProductItem` - получение отдельного продукта
- `createOrderProducts` - оформление заказа

#### Тип ApiListResponse
Является дженериком, принимает как аргумент тип `Type`, описывает типы данных для следующих полей данных продукта, получаемого с сервера:
- итоговая стоимость заказа
- список товаров типа `Type`

#### Тип ApiPostMethods
Описывает методы отправки запросов на сервер. Может принимать одно из трёх значений:
- `POST` - метод для отправки данных на сервер
- `PUT` - метод для полного обновления указанного ресурса
- `DELETE` - метод для удаления ресурса с сервера

#### IEvents
Описывает методы взаимодействия с событиями:
- `on` - подписка на событие
- `emit` - инициализация события

#### Тип EventName
Описывает тип данных имени события

#### Тип Subscriber
Описывает тип данных подписчика на событие

#### IBasketView
Описывает следующие типы данных для полей экземпляра класса корзины: 
- список покупок
- итоговая стоимость заказа
- выбранные для покупки товары

#### IFormState
Описывает следующие типы данных для полей экземпляра класса формы:
- логическое значение показывающая валидны ли данные формы
- список ошибок формы

#### Тип SelectorCollection
Является дженериком, принимает как аргумент тип данных `T`. Описывает тип данных элемента селектора, передаваемого в функцию `ensureAllElements`.

#### Тип SelectorElement
Является дженериком, принимает как аргумент тип данных `T`. Описывает тип данных элемента селектора, передаваемого в функцию `ensureElement`.

### Классы

#### Базовый код

#### Класс Component
Базовый абстрактный класс. Является дженериком, принимает в качестве аргумента тип `T`. Используется для отображения содержимого страницы с помощью метода `render`, который принимает `T` в качестве типа отображаемых данных. От данного класса наследуются классы `View`, `Card` и `Success`.

#### Класс View
Наследуется от класса `Component`. Является дженериком, принимает тот же тип `T`, что и `Component`. Отвечает за отображение элементов, генерирующих события. От данного класса наследуются классы  `Modal` и `Page`.

#### Класс EventEmitter
Брокер событий, реализующий паттерн "наблюдатель". Импелементирует интерфейс `IEvents`. Содержит поле `_events`, являющееся коллекцией пар ключ-значение, где ключом является имя события, а значением множество подписчиков этого события.

#### Класс Api
Предназначен для работы с запросами. Содержит поле базового URL `baseURL` и поле настроек `options`. Содержит следующие методы:
- `get` - принимает как аргумент строковый элемент эндпойнта `uri` и позволяет выполнить get-запрос к серверу на заданный эндпойнт
- `post` - принимает как аргумент строковый элемент эндпойнта `uri` и позволяет выполнить post-запрос к серверу на заданный эндпойнт

#### Основные классы

#### Класс Card
Описывает элемент карточки товара в магазине. Содержит элемент кнопки. Наследуется от базового класса `Component` с переданным типом `IProduct`. Содержит методы `set` для установки значений параметров.

#### Класс Basket
Описывает элемент корзины с покупками. Содержит следующие поля:
- элемента списка покупок
- элемента, отображающего итоговую стоимость заказа
- элемента кнопки "Оформить"

Имплементирует интерфейс IBasketView и содержит методы `set` для установки описанных в нём полей

#### Класс Success
Отвечает за отображение содержимого модального окна, уведомляющего о том, что заказ был выполнен успешно. Наследуется от класса `Component` с переданным типом `ISuccess`.

#### Класс Modal 
Описывает элемент модального окна оформления заказа. Содержит поле, описывающее содержащийся внутри модального окна контент и поле кнопки оформления заказа. Также содержит методы `open` и `close`, отвечающие за отображение и скрытие модального окна соответственно. Наследуется от класса `View` с переданным типом `IModalData`.

#### Класс AppData
Отвечает за взаимодействие с компонентами на главной странице магазина, а также за валидацию формы оформления заказа. Содержит следующие поля:
- Список продуктов
- Корзина
- Заказ
- Превью продута
- Ошибки формы оформления заказа

Содержит следующие методы для взаимодействия с компонентами:
- `clearBasket` - очистка корзины
- `setItems` - установка продуктов
- `setPreview` - установка превью
- `setOrderField` - установка заказа
- `validateOrder` - валидация формы оформления заказа
  
В конструкторе принимает защищённое поле событий.

#### Класс Page 
Описывает главную страницу магазина. Содержит следующие поля: 
- обёртка главной страницы
- каталог товаров
- элемент корзины
- счётчик количества товаров в корзине

Наследуется от класса `View` с переданным типом `IPage`.

#### Класс WebLarekAPI
Содержит методы, предназначенные для взаимодействия с бэкэндом. Наследуется от класса `Api` и имплементирует интерфейс `IWebLarekAPI`.

#### Презентер
В данном приложении презентером является код в файле `index.ts`. В данном файле описывается взаимодействие между слоем отображения и слоем данных.

### Список событий, используемых в приложении
#### События изменения модели данных
- `items:change` - изменение массива товаров каталога
- `preview:change` - изменение открываемого в модальном окне товара
- `basket:change` - изменение списка товаров корзины
- `order:ready` - данные форм оформления заказа валидны
- `formErrors:change` - изменение ошибки валидации  форм
#### События, возникающие при взаимодействии пользователя с интерфейсом
- `order:open` - открытие модального окна с формой оформления заказа
- `basket:open` - открытие модального окна корзины
- `card:select` - открытие описания товара в модальном окне
- `^order\..*:change` - изменение данных в форме с данными заказа
- `^contacts\..*:change` - изменение данных в форме с контактными данными
- `contacts:submit` - отправка формы контактных данных пользователя в модальном окне заказа
- `order:submit` - событие, генерируемое при отправке формы со способом оплаты и адресом
- `modal:open` - открытие любого модального окна
- `modal:close` - закрытие любого модального окна
